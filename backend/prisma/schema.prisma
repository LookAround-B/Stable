// This is your Prisma schema file for PostgreSQL
// Learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Employee {
  id                    String      @id @default(cuid())
  fullName              String
  email                 String      @unique
  password              String
  phoneNumber           String?
  designation           String      // Role as per PRD: Guard, Gardener, Housekeeping, Electrician, Ground Supervisor, Groom, Riding Boy, Rider, Instructor, Farrier, Jamedar, Stable Manager, Executive Admin, Senior Executive Accounts, Executive Accounts, School Administrator, Director
  department            String      // 'Ground Operations', 'Stable Operations', 'Accounts/Administration', 'Leadership'
  colorCode             String?
  profileImage          String?
  shiftTiming           String?     // For Guards and Electrician: Morning, Afternoon, Evening, Night
  employmentStatus      String      @default("Active") // 'Active', 'Inactive', 'On Leave'
  isApproved            Boolean     @default(false)
  supervisorId          String?     // Direct reporting manager
  supervisor            Employee?   @relation("supervision", fields: [supervisorId], references: [id], onDelete: SetNull)
  subordinates          Employee[]  @relation("supervision")
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  // Relations
  assignedTasks         Task[]
  createdTasks          Task[]      @relation("TaskCreatedBy")
  attendanceLogs        AttendanceLog[]
  healthRecords         HealthRecord[]
  createdApprovals      Approval[] @relation("approver")
  createdReports        Report[] @relation("reporter")
  reportedReports       Report[] @relation("reportedEmployee")
  auditLogs             AuditLog[]
  notifications         Notification[]
  supervisedHorses      Horse[] @relation("horseSupervision")
  assignedHorses        HorseCareTeam[] @relation("assignedStaff")
  gateAttendanceLogs    GateAttendanceLog[]
  jamiedarMedicineLogs  MedicineLog[]  @relation("jamiedarMedicineLogs")
  attendanceRecords     Attendance[] @relation("attendanceRecords")
  groomWorkSheets       GroomWorkSheet[] @relation("groomWorkSheets")
  gateEntries           GateEntry[] @relation("gateEntries")
  gateEntriesAsEmployee GateEntry[] @relation("gateEntriesAsEmployee")
  instructorRecords     InstructorDailyWorkRecord[] @relation("instructorRecords")
  riderRecords          InstructorDailyWorkRecord[] @relation("riderRecords")
  horseFeedRecords      HorseFeed[] @relation("horseFeedRecords")
  expensesCreated       Expense[] @relation("expenseCreatedBy")
  assignedExpenses      Expense[] @relation("employeeExpenses")
  inspectionRounds      InspectionRound[] @relation("inspectionRounds")
  resolvedInspections   InspectionRound[] @relation("resolvedInspections")
  roundChecks           JamedarRoundCheck[] @relation("roundChecks")
  finesIssued           Fine[] @relation("finesIssued")
  finesReceived         Fine[] @relation("finesReceived")
  finesResolved         Fine[] @relation("finesResolved")
  meetingsCreated       Meeting[] @relation("meetingsCreated")
  meetingParticipants   MeetingParticipant[] @relation("meetingParticipants")
  feedInventoryRecords  FeedInventory[] @relation("feedInventoryRecords")
  medicineInventoryRecords MedicineInventory[] @relation("medicineInventoryRecords")
  medicineLogsApproved  MedicineLog[] @relation("medicineLogsApproved")
  groceriesInventory    GroceriesInventory[] @relation("groceriesInventory")
  groceriesInventoryCreated GroceriesInventory[] @relation("groceriesInventoryCreated")


  @@index([designation])
  @@index([department])
  @@index([supervisorId])
  @@index([email])
}

model Horse {
  id                    String      @id @default(cuid())
  name                  String      @unique
  gender                String      // 'Male', 'Female'
  dateOfBirth           DateTime
  breed                 String?
  color                 String?
  height                Float?
  age                   Int?        // Calculated from DOB
  location              String?     // Stable location/ID
  stableNumber          String?     @unique // Unique alphanumeric (e.g., A12, B7, ST-09) for location ID, record tracking, billing
  profileImage          String?
  status                String      @default("Active") // 'Active', 'Rest', 'Injured', 'Traveling'
  discipline            String?     // 'Dressage', 'Jumping', 'Polo', etc.
  trainingLevel         String?     // Training level
  workloadLimit         String?     // 'Light', 'Medium', 'Heavy'
  
  // Measurements
  girthSize             String?
  bitSize               String?
  rugSize               String?
  bridleSize            String?
  numnahSize            String?
  
  // Identification
  ueln                  String?     // Universal Equine Life Number
  microchipNumber       String?
  feiId                 String?
  feiIdExpiry           DateTime?
  passportDetails       String?
  
  // Pedigree
  sire                  String?     // Father
  damsire               String?     // Mother's father
  
  // Ownership
  ownerName             String?
  ownerContact          String?
  leaseStatus           String?     // 'Owned', 'Leased', 'Training'
  emergencyContact      String?
  insuranceDetails      String?
  
  // Supervisor/Manager
  supervisorId          String?     // Assigned Stable Manager/Instructor
  supervisor            Employee?   @relation("horseSupervision", fields: [supervisorId], references: [id], onDelete: SetNull)
  
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  // Relations
  tasks                 Task[]
  healthRecords         HealthRecord[]
  medicineLogs          MedicineLog[]  @relation("medicineLogs")
  careTeam              HorseCareTeam[]
  groomWorkEntries      WorkSheetEntry[] @relation("groomWorkEntries")
  workRecords           InstructorDailyWorkRecord[] @relation("workRecords")
  feedRecords           HorseFeed[] @relation("horseFeedRecords")
  expenses              Expense[] @relation("horseExpenses")
  inspectionRounds      InspectionRound[] @relation("inspectionRounds")

  @@index([status])
  @@index([name])
  @@index([supervisorId])
}

model Task {
  id                    String      @id @default(cuid())
  name                  String
  type                  String      // 'Daily', 'Weekly', 'Event-based'
  status                String      @default("Pending") // 'Pending', 'In Progress', 'Completed', 'Pending Review', 'Approved', 'Rejected'
  horseId               String?
  horse                 Horse?      @relation(fields: [horseId], references: [id], onDelete: SetNull)
  assignedEmployeeId    String
  assignedEmployee      Employee    @relation(fields: [assignedEmployeeId], references: [id])
  createdById           String
  createdBy             Employee    @relation("TaskCreatedBy", fields: [createdById], references: [id])
  scheduledTime         DateTime
  completedTime         DateTime?
  submittedAt           DateTime?   // When employee submitted completion
  priority              String      @default("Medium") // 'Low', 'Medium', 'High', 'Urgent'
  requiredProof         Boolean     @default(false)
  proofImage            String?
  completionNotes       String?     // Notes from employee about task completion
  description           String?
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  // Relations
  approvals             Approval[]

  @@index([horseId])
  @@index([assignedEmployeeId])
  @@index([createdById])
  @@index([status])
  @@index([scheduledTime])
}

model Approval {
  id                    String      @id @default(cuid())
  taskId                String
  task                  Task        @relation(fields: [taskId], references: [id], onDelete: Cascade)
  approverId            String
  approver              Employee    @relation("approver", fields: [approverId], references: [id])
  approverLevel         String      // 'Zamindar', 'Instructor', 'Admin'
  status                String      @default("Pending") // 'Pending', 'Approved', 'Rejected'
  comments              String?
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@index([taskId])
  @@index([approverId])
  @@unique([taskId, approverId])
}

model Report {
  id                    String      @id @default(cuid())
  reportedEmployeeId    String
  reportedEmployee      Employee    @relation("reportedEmployee", fields: [reportedEmployeeId], references: [id])
  reporterEmployeeId    String
  reporter              Employee    @relation("reporter", fields: [reporterEmployeeId], references: [id])
  reason                String
  category              String?
  taskId                String?
  status                String      @default("Pending") // 'Pending', 'Reviewed', 'Closed'
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@index([reportedEmployeeId])
  @@index([reporterEmployeeId])
}

model HealthRecord {
  id                    String      @id @default(cuid())
  horseId               String
  horse                 Horse       @relation(fields: [horseId], references: [id], onDelete: Cascade)
  healthAdvisorId       String?
  healthAdvisor         Employee?   @relation(fields: [healthAdvisorId], references: [id])
  recordType            String      // 'Vaccination', 'Deworming', 'Injury', 'Vet Visit', 'Farrier Visit', 'Medication'
  description           String?
  date                  DateTime
  nextDueDate           DateTime?
  documents             String?
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@index([horseId])
  @@index([healthAdvisorId])
  @@index([date])
}

model Notification {
  id                    String      @id @default(cuid())
  employeeId            String
  employee              Employee    @relation(fields: [employeeId], references: [id], onDelete: Cascade)
  type                  String      // 'task_assignment', 'approval_request', 'task_completion', 'report_filed'
  title                 String
  message               String
  isRead                Boolean     @default(false)
  relatedTaskId         String?
  relatedApprovalId     String?
  createdAt             DateTime    @default(now())
  readAt                DateTime?

  @@index([employeeId])
  @@index([isRead])
}

model AuditLog {
  id                    String      @id @default(cuid())
  userId                String
  user                  Employee    @relation(fields: [userId], references: [id])
  action                String      // 'CREATE', 'UPDATE', 'DELETE', 'LOGIN', 'APPROVE'
  entityType            String      // 'Task', 'Horse', 'Employee', 'Report'
  entityId              String
  changes               String?     // JSON string of changes
  ipAddress             String?
  userAgent             String?
  createdAt             DateTime    @default(now())

  @@index([userId])
  @@index([action])
  @@index([createdAt])
}

// Manual Attendance Logging System
model AttendanceLog {
  id                    String      @id @default(cuid())
  employeeId            String
  employee              Employee    @relation(fields: [employeeId], references: [id], onDelete: Cascade)
  date                  DateTime    @default(now())
  timeIn                DateTime
  timeOut               DateTime?
  shift                 String?     // For Guards and Electrician only
  notes                 String?
  approvedBy            String?     // Supervisor approval
  isApproved            Boolean     @default(false)
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@index([employeeId])
  @@index([date])
}

// Gate Attendance (Guards only) - records all staff and visitors
model GateAttendanceLog {
  id                    String      @id @default(cuid())
  guardId               String
  guard                 Employee    @relation(fields: [guardId], references: [id], onDelete: Cascade)
  personName            String      // Staff member or visitor name
  personType            String      // 'Staff' or 'Visitor'
  entryTime             DateTime
  exitTime              DateTime?
  notes                 String?
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@index([guardId])
  @@index([entryTime])
}

// Visitor Management (Housekeeping)
model VisitorLog {
  id                    String      @id @default(cuid())
  visitorName           String
  purpose               String
  checkInTime           DateTime
  checkOutTime          DateTime?
  contactPerson         String?
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt
}

// Medicine/Treatment Log (Jamedar)
model MedicineLog {
  id                    String      @id @default(cuid())
  jamiedarId            String
  jamedar               Employee    @relation("jamiedarMedicineLogs", fields: [jamiedarId], references: [id], onDelete: Cascade)
  horseId               String
  horse                 Horse       @relation("medicineLogs", fields: [horseId], references: [id], onDelete: Cascade)
  medicineName          String
  quantity              Float
  unit                  String      @default("ml") // ml, g, tablets, vials, etc.
  timeAdministered      DateTime
  notes                 String?
  photoUrl              String?     // Before/after photos
  stockAlert            Boolean     @default(false)
  
  // Approval workflow - Stable Manager approves
  approvalStatus        String      @default("pending") // pending, approved, rejected
  approvedById          String?
  approvedBy            Employee?   @relation("medicineLogsApproved", fields: [approvedById], references: [id], onDelete: SetNull)
  rejectionReason       String?
  approvalDate          DateTime?
  
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@index([jamiedarId])
  @@index([horseId])
  @@index([approvalStatus])
}

// Horse Care Team Assignment
model HorseCareTeam {
  id                    String      @id @default(cuid())
  horseId               String
  horse                 Horse       @relation(fields: [horseId], references: [id], onDelete: Cascade)
  staffId               String
  staff                 Employee    @relation("assignedStaff", fields: [staffId], references: [id], onDelete: Cascade)
  role                  String      // 'Groom', 'Rider', 'Instructor', 'Jamedar', 'Farrier'
  isActive              Boolean     @default(true)
  assignedDate          DateTime    @default(now())
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@unique([horseId, staffId, role])
  @@index([horseId])
  @@index([staffId])
}

model SystemSettings {
  id                    String      @id @default(cuid())
  key                   String      @unique
  value                 String
  description           String?
  updatedAt             DateTime    @updatedAt
}

// Groom Work Sheet - Daily record of groom activities
model GroomWorkSheet {
  id                    String      @id @default(cuid())
  groomId               String      // Employee ID of groom
  groom                 Employee    @relation("groomWorkSheets", fields: [groomId], references: [id], onDelete: Cascade)
  date                  DateTime    @default(now())
  totalAM               Float       @default(0) // Total morning hours
  totalPM               Float       @default(0) // Total afternoon hours
  wholeDayHours         Float       @default(0) // Total hours for the day
  woodchipsUsed         Float       @default(0) // Total woodchips in units
  bichaliUsed           Float       @default(0) // Total bichali in kg
  booSaUsed             Int         @default(0) // Total boo sa (hay) bags
  remarks               String?
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt
  entries               WorkSheetEntry[]

  @@index([groomId])
  @@index([date])
}

// Individual horse entries in groom work sheet
model WorkSheetEntry {
  id                    String      @id @default(cuid())
  worksheetId           String
  worksheet             GroomWorkSheet @relation(fields: [worksheetId], references: [id], onDelete: Cascade)
  horseId               String
  horse                 Horse       @relation("groomWorkEntries", fields: [horseId], references: [id], onDelete: Cascade)
  amHours               Float       @default(0)
  pmHours               Float       @default(0)
  wholeDayHours         Float       @default(0)
  woodchipsUsed         Float       @default(0) // Woodchips (B) in units
  bichaliUsed           Float       @default(0) // Bichali in kg (bags)
  booSaUsed             Int         @default(0) // Boo sa in bags
  remarks               String?
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@index([worksheetId])
  @@index([horseId])
}

// Enhanced Attendance Log with status tracking for all staff
model Attendance {
  id                    String      @id @default(cuid())
  employeeId            String
  employee              Employee    @relation("attendanceRecords", fields: [employeeId], references: [id], onDelete: Cascade)
  date                  DateTime
  checkInTime           DateTime?
  checkOutTime          DateTime?
  status                String      @default("Present") // 'Present', 'Absent', 'Leave', 'WOFF' (Weekly Off), 'Half Day'
  remarks               String?
  markedAt              DateTime?   // Timestamp when attendance was marked
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@index([employeeId])
  @@index([date])
  @@index([status])
}

// Gate Entry/Exit Register (managed by Guards)
model GateEntry {
  id                    String      @id @default(cuid())
  guardId               String
  guard                 Employee    @relation("gateEntries", fields: [guardId], references: [id], onDelete: Cascade)
  personType            String      // 'Staff' or 'Visitor'
  employeeId            String?     // For staff entries
  employee              Employee?   @relation("gateEntriesAsEmployee", fields: [employeeId], references: [id], onDelete: SetNull)
  visitorId             String?     // For visitor entries
  visitor               Visitor?    @relation(fields: [visitorId], references: [id], onDelete: SetNull)
  vehicleNo             String?     // Vehicle registration number
  entryTime             DateTime
  exitTime              DateTime?
  notes                 String?     // Additional notes/remarks
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@index([guardId])
  @@index([employeeId])
  @@index([visitorId])
  @@index([entryTime])
  @@index([personType])
}

// Visitor Information (for gate entry tracking)
model Visitor {
  id                    String      @id @default(cuid())
  name                  String
  purpose               String
  contactNumber         String?
  gateEntries           GateEntry[]
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@index([name])
}
// Instructor Daily Work Records (EIRS) - Source of truth for billing
model InstructorDailyWorkRecord {
  id                    String      @id @default(cuid())
  instructorId          String      // Instructor who supervised
  instructor            Employee    @relation("instructorRecords", fields: [instructorId], references: [id], onDelete: Cascade)
  horseId               String      // Horse that was ridden
  horse                 Horse       @relation("workRecords", fields: [horseId], references: [id], onDelete: Cascade)
  riderId               String      // Student/Rider
  rider                 Employee    @relation("riderRecords", fields: [riderId], references: [id], onDelete: Cascade)
  workType              String      // 'Lesson', 'Training', 'Exercise', 'Rehab', etc.
  duration              Int         // Duration in minutes
  date                  DateTime    // Date of the session
  notes                 String?     // Optional notes
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@unique([instructorId, horseId, riderId, date]) // Prevent exact duplicate sessions on same day
  @@index([instructorId])
  @@index([horseId])
  @@index([riderId])
  @@index([date])
}

// Horse Feed Records
model HorseFeed {
  id                    String      @id @default(cuid())
  recordedById          String      // Stable Manager or Ground Supervisor
  recordedBy            Employee    @relation("horseFeedRecords", fields: [recordedById], references: [id], onDelete: Cascade)
  horseId               String
  horse                 Horse       @relation("horseFeedRecords", fields: [horseId], references: [id], onDelete: Cascade)
  date                  DateTime    // Date of feed record
  
  // Feed quantities (in kg or standard units)
  balance               Float?
  barley                Float?
  oats                  Float?
  soya                  Float?
  lucerne               Float?
  linseed               Float?
  rOil                  Float?      // R.Oil
  biotin                Float?
  joint                 Float?
  epsom                 Float?
  heylase               Float?
  
  notes                 String?     // Optional notes
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@unique([horseId, date])  // Only one feed record per horse per day
  @@index([recordedById])
  @@index([horseId])
  @@index([date])
}

model Expense {
  id                    String      @id @default(cuid())
  type                  String      // 'Medicine', 'Treatment', 'Maintenance', 'Miscellaneous'
  amount                Float
  description           String
  date                  DateTime
  createdById           String
  createdBy             Employee    @relation("expenseCreatedBy", fields: [createdById], references: [id])
  
  // Assignment - can be either horse OR employee, not both
  horseId               String?
  horse                 Horse?      @relation("horseExpenses", fields: [horseId], references: [id], onDelete: SetNull)
  employeeId            String?
  employee              Employee?   @relation("employeeExpenses", fields: [employeeId], references: [id], onDelete: SetNull)
  
  // Attachments - JSON array of file URLs
  attachments           String?     // JSON array of attachment URLs
  
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@index([createdById])
  @@index([horseId])
  @@index([employeeId])
  @@index([type])
  @@index([date])
}

model InspectionRound {
  id                    String      @id @default(cuid())
  jamedarId             String
  jamedar               Employee    @relation("inspectionRounds", fields: [jamedarId], references: [id], onDelete: Cascade)
  round                 String      // 'Morning', 'Afternoon', 'Evening'
  image                 String      // Image file URL
  description           String      // Inspection description (max 500 chars)
  horseId               String?
  horse                 Horse?      @relation("inspectionRounds", fields: [horseId], references: [id], onDelete: SetNull)
  location              String      // Location text (max 100 chars)
  severityLevel         String      // 'Low', 'Medium', 'High', 'Critical'
  
  // Comments and Resolution
  comments              String?     // Comments from reviewers (max 500 chars)
  status                String      @default("Open") // 'Open', 'Resolved'
  resolvedById          String?
  resolvedBy            Employee?   @relation("resolvedInspections", fields: [resolvedById], references: [id], onDelete: SetNull)
  resolutionNotes       String?     // Resolution notes (max 500 chars)
  resolvedAt            DateTime?
  
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@index([jamedarId])
  @@index([round])
  @@index([horseId])
  @@index([severityLevel])
  @@index([status])
  @@index([createdAt])
}

model Fine {
  id                    String      @id @default(cuid())
  issuedById            String
  issuedBy              Employee    @relation("finesIssued", fields: [issuedById], references: [id], onDelete: Cascade)
  issuedToId            String
  issuedTo              Employee    @relation("finesReceived", fields: [issuedToId], references: [id], onDelete: Cascade)
  reason                String      // Reason for fine (max 500 chars)
  amount                Float?      // Fine amount in rupees (optional for backwards compatibility)
  evidenceImage         String      // Evidence image URL (mandatory)
  status                String      @default("Open") // 'Open', 'Resolved', 'Dismissed'
  resolvedById          String?
  resolvedBy            Employee?   @relation("finesResolved", fields: [resolvedById], references: [id], onDelete: SetNull)
  resolutionNotes       String?     // Notes when resolving
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@index([issuedById])
  @@index([issuedToId])
  @@index([status])
  @@index([createdAt])
}

model Meeting {
  id                    String      @id @default(cuid())
  title                 String
  description           String?
  meetingDate           DateTime    // Date of the meeting
  meetingTime           String?     // Time as string (e.g., "10:30 AM")
  location              String?
  createdById           String
  createdBy             Employee    @relation("meetingsCreated", fields: [createdById], references: [id], onDelete: Cascade)
  status                String      @default("Scheduled") // 'Scheduled', 'Completed', 'Cancelled'
  participants          MeetingParticipant[]
  mom                   MeetingMOM?
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@index([createdById])
  @@index([status])
  @@index([meetingDate])
}

model MeetingParticipant {
  id                    String      @id @default(cuid())
  meetingId             String
  meeting               Meeting     @relation(fields: [meetingId], references: [id], onDelete: Cascade)
  employeeId            String
  employee              Employee    @relation("meetingParticipants", fields: [employeeId], references: [id], onDelete: Cascade)
  createdAt             DateTime    @default(now())

  @@unique([meetingId, employeeId])
  @@index([meetingId])
  @@index([employeeId])
}

model MeetingMOM {
  id                    String      @id @default(cuid())
  meetingId             String      @unique
  meeting               Meeting     @relation(fields: [meetingId], references: [id], onDelete: Cascade)
  pointsDiscussed       String?     // JSON array of points
  memberInputs          String?     // JSON array of inputs from members
  decisions             String?     // JSON array of decisions made
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@index([meetingId])
}

model JamedarRoundCheck {
  id                    String      @id @default(cuid())
  jamedarId             String
  jamedar               Employee    @relation("roundChecks", fields: [jamedarId], references: [id], onDelete: Cascade)
  checkDate             DateTime    // Date of the round check (stored as date only)
  morningCompleted      Boolean     @default(false)
  afternoonCompleted    Boolean     @default(false)
  eveningCompleted      Boolean     @default(false)
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@unique([jamedarId, checkDate])
  @@index([jamedarId])
  @@index([checkDate])
}

model FeedInventory {
  id                    String      @id @default(cuid())
  feedType              String      // 'barley', 'oats', 'soya', 'lucerne', 'linseed', 'rOil', 'biotin', 'joint', 'epsom', 'heylase', 'balance'
  month                 Int         // Month (1-12)
  year                  Int         // Year (e.g. 2026)
  unitsBrought          Float       @default(0)  // Units purchased/received this month
  openingStock          Float       @default(0)  // Stock at beginning of month
  totalUsed             Float       @default(0)  // Total units consumed (auto-calculated from HorseFeed)
  unitsLeft             Float       @default(0)  // Remaining units (openingStock + unitsBrought - totalUsed)
  unit                  String      @default("kg") // Unit of measurement (kg, liters, packets, etc.)
  notes                 String?
  recordedById          String
  recordedBy            Employee    @relation("feedInventoryRecords", fields: [recordedById], references: [id], onDelete: Cascade)
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@unique([feedType, month, year])  // One entry per feed type per month
  @@index([feedType])
  @@index([month, year])
  @@index([recordedById])
}

model MedicineInventory {
  id                    String      @id @default(cuid())
  medicineType          String      // 'antibiotic', 'antiseptic', 'painkiller', 'vitamin', 'dewormer', 'injection', 'ointment', 'supplement'
  month                 Int         // Month (1-12)
  year                  Int         // Year (e.g. 2026)
  unitsPurchased        Float       @default(0)  // Units purchased/received this month
  openingStock          Float       @default(0)  // Stock at beginning of month
  totalUsed             Float       @default(0)  // Total units consumed
  unitsLeft             Float       @default(0)  // Remaining units (openingStock + unitsPurchased - totalUsed)
  unit                  String      @default("ml") // Unit of measurement (ml, g, tablets, vials, etc.)
  notes                 String?
  recordedById          String
  recordedBy            Employee    @relation("medicineInventoryRecords", fields: [recordedById], references: [id], onDelete: Cascade)
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@unique([medicineType, month, year])  // One entry per medicine type per month
  @@index([medicineType])
  @@index([month, year])
  @@index([recordedById])
}

model GroceriesInventory {
  id                    String      @id @default(cuid())
  name                  String      // Name of grocery item
  quantity              Float       // Quantity purchased/in stock
  unit                  String      @default("kg") // kg, liters, boxes, units, etc.
  price                 Float       // Price per unit
  totalPrice            Float       // quantity * price
  description           String?     // Optional description
  employeeId            String?     // Who got it (optional)
  employee              Employee?   @relation("groceriesInventory", fields: [employeeId], references: [id], onDelete: SetNull)
  createdById           String      // Who created this entry (Senior/Junior Executive Admin)
  createdBy             Employee    @relation("groceriesInventoryCreated", fields: [createdById], references: [id], onDelete: Cascade)
  createdAt             DateTime    @default(now())
  updatedAt             DateTime    @updatedAt

  @@index([createdById])
  @@index([employeeId])
  @@index([createdAt])
}